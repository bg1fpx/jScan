<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>jScan</title>

<style type="text/css">
body { background:white;
       color:black; }
body, p, td, input, div, a, span { font:14px/130% "Courier New"; }
p { text-align:center; }
a:link, a:active, a:visited { color:blue;
                              text-decoration:none; }
a:hover { color:red; }
table { margin:auto; }
.red { color:red; }
.blue { color:blue; }
</style>

<script type="text/javascript">
var list = new Array("173.194.0", "173.194.1", "173.194.2", "173.194.3", "173.194.4", "173.194.5", "173.194.6", "173.194.7", "173.194.8", "173.194.9",
"173.194.10", "173.194.11", "173.194.12", "173.194.13", "173.194.14", "173.194.15", "173.194.16", "173.194.17", "173.194.18", "173.194.19",
"173.194.20", "173.194.21", "173.194.22", "173.194.23", "173.194.24", "173.194.25", "173.194.26", "173.194.27", "173.194.28", "173.194.29",
"173.194.30", "173.194.31", "173.194.32", "173.194.33", "173.194.34", "173.194.35", "173.194.36", "173.194.37", "173.194.38", "173.194.39",
"173.194.40", "173.194.41", "173.194.42", "173.194.43", "173.194.44", "173.194.45", "173.194.46", "173.194.47", "173.194.48", "173.194.49",
"173.194.50", "173.194.51", "173.194.52", "173.194.53", "173.194.54", "173.194.55", "173.194.56", "173.194.57", "173.194.58", "173.194.59",
"173.194.60", "173.194.61", "173.194.62", "173.194.63", "173.194.64", "173.194.65", "173.194.66", "173.194.67", "173.194.68", "173.194.69",
"173.194.70", "173.194.71", "173.194.72", "173.194.73", "173.194.74", "173.194.75", "173.194.76", "173.194.77", "173.194.78", "173.194.79",
"173.194.80", "173.194.81", "173.194.82", "173.194.83", "173.194.84", "173.194.85", "173.194.86", "173.194.87", "173.194.88", "173.194.89",
"173.194.90", "173.194.91", "173.194.92", "173.194.93", "173.194.94", "173.194.95", "173.194.96", "173.194.97", "173.194.98", "173.194.99",
"173.194.100", "173.194.101", "173.194.102", "173.194.103", "173.194.104", "173.194.105", "173.194.106", "173.194.107", "173.194.108", "173.194.109",
"173.194.110", "173.194.111", "173.194.112", "173.194.113", "173.194.114", "173.194.115", "173.194.116", "173.194.117", "173.194.118", "173.194.119",
"173.194.120", "173.194.121", "173.194.122", "173.194.123", "173.194.124", "173.194.125", "173.194.126", "173.194.127", "173.194.128", "173.194.129",
"173.194.130", "173.194.131", "173.194.132", "173.194.133", "173.194.134", "173.194.135", "173.194.136", "173.194.137", "173.194.138", "173.194.139",
"173.194.140", "173.194.141", "173.194.142", "173.194.143", "173.194.144", "173.194.145", "173.194.146", "173.194.147", "173.194.148", "173.194.149",
"173.194.150", "173.194.151", "173.194.152", "173.194.153", "173.194.154", "173.194.155", "173.194.156", "173.194.157", "173.194.158", "173.194.159",
"173.194.160", "173.194.161", "173.194.162", "173.194.163", "173.194.164", "173.194.165", "173.194.166", "173.194.167", "173.194.168", "173.194.169",
"173.194.170", "173.194.171", "173.194.172", "173.194.173", "173.194.174", "173.194.175", "173.194.176", "173.194.177", "173.194.178", "173.194.179",
"173.194.180", "173.194.181", "173.194.182", "173.194.183", "173.194.184", "173.194.185", "173.194.186", "173.194.187", "173.194.188", "173.194.189",
"173.194.190", "173.194.191", "173.194.192", "173.194.193", "173.194.194", "173.194.195", "173.194.196", "173.194.197", "173.194.198", "173.194.199",
"173.194.200", "173.194.201", "173.194.202", "173.194.203", "173.194.204", "173.194.205", "173.194.206", "173.194.207", "173.194.208", "173.194.209",
"173.194.210", "173.194.211", "173.194.212", "173.194.213", "173.194.214", "173.194.215", "173.194.216", "173.194.217", "173.194.218", "173.194.219",
"173.194.220", "173.194.221", "173.194.222", "173.194.223", "173.194.224", "173.194.225", "173.194.226", "173.194.227", "173.194.228", "173.194.229",
"173.194.230", "173.194.231", "173.194.232", "173.194.233", "173.194.234", "173.194.235", "173.194.236", "173.194.237", "173.194.238", "173.194.239",
"173.194.240", "173.194.241", "173.194.242", "173.194.243", "173.194.244", "173.194.245", "173.194.246", "173.194.247", "173.194.248", "173.194.249",
"173.194.250", "173.194.251", "173.194.252", "173.194.253", "173.194.254", "173.194.255",

"207.126.144", "207.126.145", "207.126.146", "207.126.147", "207.126.148", "207.126.149", "207.126.150", "207.126.151", "207.126.152", "207.126.153",
"207.126.154", "207.126.155", "207.126.156", "207.126.157", "207.126.158", "207.126.159",

"209.85.128", "209.85.129", "209.85.130", "209.85.131", "209.85.132", "209.85.133", "209.85.134", "209.85.135", "209.85.136", "209.85.137",
"209.85.138", "209.85.139", "209.85.140", "209.85.141", "209.85.142", "209.85.143", "209.85.144", "209.85.145", "209.85.146", "209.85.147",
"209.85.148", "209.85.149", "209.85.150", "209.85.151", "209.85.152", "209.85.153", "209.85.154", "209.85.155", "209.85.156", "209.85.157",
"209.85.158", "209.85.159", "209.85.160", "209.85.161", "209.85.162", "209.85.163", "209.85.164", "209.85.165", "209.85.166", "209.85.167",
"209.85.168", "209.85.169", "209.85.170", "209.85.171", "209.85.172", "209.85.173", "209.85.174", "209.85.175", "209.85.176", "209.85.177",
"209.85.178", "209.85.179", "209.85.180", "209.85.181", "209.85.182", "209.85.183", "209.85.184", "209.85.185", "209.85.186", "209.85.187",
"209.85.188", "209.85.189", "209.85.190", "209.85.191", "209.85.192", "209.85.193", "209.85.194", "209.85.195", "209.85.196", "209.85.197",
"209.85.198", "209.85.199", "209.85.200", "209.85.201", "209.85.202", "209.85.203", "209.85.204", "209.85.205", "209.85.206", "209.85.207",
"209.85.208", "209.85.209", "209.85.210", "209.85.211", "209.85.212", "209.85.213", "209.85.214", "209.85.215", "209.85.216", "209.85.217",
"209.85.218", "209.85.219", "209.85.220", "209.85.221", "209.85.222", "209.85.223", "209.85.224", "209.85.225", "209.85.226", "209.85.227",
"209.85.228", "209.85.229", "209.85.230", "209.85.231", "209.85.232", "209.85.233", "209.85.234", "209.85.235", "209.85.236", "209.85.237",
"209.85.238", "209.85.239", "209.85.240", "209.85.241", "209.85.242", "209.85.243", "209.85.244", "209.85.245", "209.85.246", "209.85.247",
"209.85.248", "209.85.249", "209.85.250", "209.85.251", "209.85.252", "209.85.253", "209.85.254", "209.85.255",

"216.239.32", "216.239.33", "216.239.34", "216.239.35", "216.239.36", "216.239.37", "216.239.38", "216.239.39", "216.239.40", "216.239.41",
"216.239.42", "216.239.43", "216.239.44", "216.239.45", "216.239.46", "216.239.47", "216.239.48", "216.239.49", "216.239.50", "216.239.51",
"216.239.52", "216.239.53", "216.239.54", "216.239.55", "216.239.56", "216.239.57", "216.239.58", "216.239.59", "216.239.60", "216.239.61",
"216.239.62", "216.239.63",

"64.18.0", "64.18.1", "64.18.2", "64.18.3", "64.18.4", "64.18.5", "64.18.6", "64.18.7", "64.18.8", "64.18.9",
"64.18.10", "64.18.11", "64.18.12", "64.18.13", "64.18.14", "64.18.15",

"64.233.160", "64.233.161", "64.233.162", "64.233.163", "64.233.164", "64.233.165", "64.233.166", "64.233.167", "64.233.168", "64.233.169",
"64.233.170", "64.233.171", "64.233.172", "64.233.173", "64.233.174", "64.233.175", "64.233.176", "64.233.177", "64.233.178", "64.233.179",
"64.233.180", "64.233.181", "64.233.182", "64.233.183", "64.233.184", "64.233.185", "64.233.186", "64.233.187", "64.233.188", "64.233.189",
"64.233.190", "64.233.191",

"66.102.0", "66.102.1", "66.102.2", "66.102.3", "66.102.4", "66.102.5", "66.102.6", "66.102.7", "66.102.8", "66.102.9",
"66.102.10", "66.102.11", "66.102.12", "66.102.13", "66.102.14", "66.102.15",

"66.249.80", "66.249.81", "66.249.82", "66.249.83", "66.249.84", "66.249.85", "66.249.86", "66.249.87", "66.249.88", "66.249.89",
"66.249.90", "66.249.91", "66.249.92", "66.249.93", "66.249.94", "66.249.95",

"72.14.192", "72.14.193", "72.14.194", "72.14.195", "72.14.196", "72.14.197", "72.14.198", "72.14.199", "72.14.200", "72.14.201",
"72.14.202", "72.14.203", "72.14.204", "72.14.205", "72.14.206", "72.14.207", "72.14.208", "72.14.209", "72.14.210", "72.14.211",
"72.14.212", "72.14.213", "72.14.214", "72.14.215", "72.14.216", "72.14.217", "72.14.218", "72.14.219", "72.14.220", "72.14.221",
"72.14.222", "72.14.223", "72.14.224", "72.14.225", "72.14.226", "72.14.227", "72.14.228", "72.14.229", "72.14.230", "72.14.231",
"72.14.232", "72.14.233", "72.14.234", "72.14.235", "72.14.236", "72.14.237", "72.14.238", "72.14.239", "72.14.240", "72.14.241",
"72.14.242", "72.14.243", "72.14.244", "72.14.245", "72.14.246", "72.14.247", "72.14.248", "72.14.249", "72.14.250", "72.14.251",
"72.14.252", "72.14.253", "72.14.254", "72.14.255",

"74.125.0", "74.125.1", "74.125.2", "74.125.3", "74.125.4", "74.125.5", "74.125.6", "74.125.7", "74.125.8", "74.125.9",
"74.125.10", "74.125.11", "74.125.12", "74.125.13", "74.125.14", "74.125.15", "74.125.16", "74.125.17", "74.125.18", "74.125.19",
"74.125.20", "74.125.21", "74.125.22", "74.125.23", "74.125.24", "74.125.25", "74.125.26", "74.125.27", "74.125.28", "74.125.29",
"74.125.30", "74.125.31", "74.125.32", "74.125.33", "74.125.34", "74.125.35", "74.125.36", "74.125.37", "74.125.38", "74.125.39",
"74.125.40", "74.125.41", "74.125.42", "74.125.43", "74.125.44", "74.125.45", "74.125.46", "74.125.47", "74.125.48", "74.125.49",
"74.125.50", "74.125.51", "74.125.52", "74.125.53", "74.125.54", "74.125.55", "74.125.56", "74.125.57", "74.125.58", "74.125.59",
"74.125.60", "74.125.61", "74.125.62", "74.125.63", "74.125.64", "74.125.65", "74.125.66", "74.125.67", "74.125.68", "74.125.69",
"74.125.70", "74.125.71", "74.125.72", "74.125.73", "74.125.74", "74.125.75", "74.125.76", "74.125.77", "74.125.78", "74.125.79",
"74.125.80", "74.125.81", "74.125.82", "74.125.83", "74.125.84", "74.125.85", "74.125.86", "74.125.87", "74.125.88", "74.125.89",
"74.125.90", "74.125.91", "74.125.92", "74.125.93", "74.125.94", "74.125.95", "74.125.96", "74.125.97", "74.125.98", "74.125.99",
"74.125.100", "74.125.101", "74.125.102", "74.125.103", "74.125.104", "74.125.105", "74.125.106", "74.125.107", "74.125.108", "74.125.109",
"74.125.110", "74.125.111", "74.125.112", "74.125.113", "74.125.114", "74.125.115", "74.125.116", "74.125.117", "74.125.118", "74.125.119",
"74.125.120", "74.125.121", "74.125.122", "74.125.123", "74.125.124", "74.125.125", "74.125.126", "74.125.127", "74.125.128", "74.125.129",
"74.125.130", "74.125.131", "74.125.132", "74.125.133", "74.125.134", "74.125.135", "74.125.136", "74.125.137", "74.125.138", "74.125.139",
"74.125.140", "74.125.141", "74.125.142", "74.125.143", "74.125.144", "74.125.145", "74.125.146", "74.125.147", "74.125.148", "74.125.149",
"74.125.150", "74.125.151", "74.125.152", "74.125.153", "74.125.154", "74.125.155", "74.125.156", "74.125.157", "74.125.158", "74.125.159",
"74.125.160", "74.125.161", "74.125.162", "74.125.163", "74.125.164", "74.125.165", "74.125.166", "74.125.167", "74.125.168", "74.125.169",
"74.125.170", "74.125.171", "74.125.172", "74.125.173", "74.125.174", "74.125.175", "74.125.176", "74.125.177", "74.125.178", "74.125.179",
"74.125.180", "74.125.181", "74.125.182", "74.125.183", "74.125.184", "74.125.185", "74.125.186", "74.125.187", "74.125.188", "74.125.189",
"74.125.190", "74.125.191", "74.125.192", "74.125.193", "74.125.194", "74.125.195", "74.125.196", "74.125.197", "74.125.198", "74.125.199",
"74.125.200", "74.125.201", "74.125.202", "74.125.203", "74.125.204", "74.125.205", "74.125.206", "74.125.207", "74.125.208", "74.125.209",
"74.125.210", "74.125.211", "74.125.212", "74.125.213", "74.125.214", "74.125.215", "74.125.216", "74.125.217", "74.125.218", "74.125.219",
"74.125.220", "74.125.221", "74.125.222", "74.125.223", "74.125.224", "74.125.225", "74.125.226", "74.125.227", "74.125.228", "74.125.229",
"74.125.230", "74.125.231", "74.125.232", "74.125.233", "74.125.234", "74.125.235", "74.125.236", "74.125.237", "74.125.238", "74.125.239",
"74.125.240", "74.125.241", "74.125.242", "74.125.243", "74.125.244", "74.125.245", "74.125.246", "74.125.247", "74.125.248", "74.125.249",
"74.125.250", "74.125.251", "74.125.252", "74.125.253", "74.125.254", "74.125.255");

function scan() // -------------------- scan --------------------
{ var valid, from, to, count, min, max, host, port, timeout, id, newline;

  valid = document.jscan.from.value.match(/^\d+.\d+.\d+.\d+$/);
  if (! valid)
  { document.getElementById("message").innerHTML = "<span class='red'>Error: invalid host</span>";
    return; }

  valid = document.jscan.to.value.match(/^\d+.\d+.\d+.\d+$/);
  if (! valid)
  { document.getElementById("message").innerHTML = "<span class='red'>Error: invalid host</span>";
    return; }

  valid = document.jscan.port.value.match(/^\d+$/);
  if (! valid)
  { document.getElementById("message").innerHTML = "<span class='red'>Error: invalid port</span>";
    return; }

  valid = document.jscan.timeout.value.match(/^\d+$/);
  if (! valid)
  { document.getElementById("message").innerHTML = "<span class='red'>Error: invalid timeout</span>";
    return; }

  valid = document.jscan.interval.value.match(/^\d+$/);
  if (! valid)
  { document.getElementById("message").innerHTML = "<span class='red'>Error: invalid interval</span>";
    return; }

  from = document.jscan.from.value.split(".");
  to = document.jscan.to.value.split(".");
  if (from[0] != to[0] || from[1] != to[1] || from[2] != to[2])
  { document.getElementById("message").innerHTML = "<span class='red'>Error: invalid host</span>";
    return; }

  for (count = 0; count <= 3; count++)
    if (Number(from[count]) > 255 || Number(to[count]) > 255)
    { document.getElementById("message").innerHTML = "<span class='red'>Error: invalid host</span>";
      return; }

  min = Number(from[3]);
  max = Number(to[3]);
  if (min > max)
  { document.getElementById("message").innerHTML = "<span class='red'>Error: invalid host</span>";
    return; }

  if (Number(document.jscan.port.value) > 65535) document.jscan.port.value = "80";
  if (Number(document.jscan.timeout.value) < 1000) document.jscan.timeout.value = "1000";
  if (Number(document.jscan.interval.value) == 0) document.jscan.interval.value = "1";

  document.getElementById("_scan").style.display = "none";
  document.getElementById("_reload").style.display = "inline";
  document.getElementById("message").innerHTML = "Results: <span class='blue'>[A]ctive</span> <span class='red'>[I]nactive</span>";

  host = from[0] + "." + from[1] + "." + from[2] + ".";
  port = document.jscan.port.value;
  timeout = document.jscan.timeout.value;

  count = 0;
  for (id = min; id <= max; id++)
  { newline = document.createElement("div");
    newline.id = id;
    document.getElementById("result").appendChild(newline);
    delay(host, id, port, timeout, count);
    count++; } }

function delay(host, id, port, timeout, count) // -------------------- delay --------------------
{ var interval = document.jscan.interval.value;
  setTimeout(function () { var request = new ping(host, id, port, timeout); }, 1000 * Number(interval) * Number(count)); }

function ping(host, id, port, timeout) // -------------------- ping --------------------
{ var img = new Image();

  // host[YES] image[NO] --> onerror --> active
  img.onerror = function () { if (! img) return;
                              img = undefined;
                              document.getElementById(id).innerHTML = "<span class='blue'>[A] " + host + id + ":" + port + "</span>"; }

  // host[YES] image[YES] --> onload --> active
  img.onload = img.onerror;

  switch (port)
  { case "21": img.src = "ftp://" + id + "@" + host + id; break;
    case "25": img.src = "mailto://" + id + "@" + host + id; break;
    case "70": img.src = "gopher://" + host + id; break;
    case "80": img.src = "http://" + host + id + "/" + id + ".jpg"; break;
    case "119": img.src = "news://" + host + id; break;
    case "443": img.src = "https://" + host + id + "/" + id + ".jpg"; break;
    default: img.src = "http://" + host + id + ":" + port + "/" + id + ".jpg"; }

  // host[NO] image[NO] --> inactive
  setTimeout(function () { if (! img) return;
                           img = undefined;
                           document.getElementById(id).innerHTML = "<span class='red'>[I] " + host + id + ":" + port + "</span>"; }, Number(timeout)); }

function show(message) // -------------------- show --------------------
{ var showbox = window.open("", "", "width=390, height=390");
  showbox.document.write("<title>jScan</title>");
  showbox.document.write("<style type='text/css'>");
  showbox.document.write("p, a, li { font:14px/130% 'Courier New'; }");
  showbox.document.write("a:link, a:active, a:visited { color:blue; text-decoration:none; }");
  showbox.document.write("a:hover { color:red; }");
  showbox.document.write("li { list-style-type:square; }");
  showbox.document.write("</style>");
  showbox.document.write(message); }

function about() // -------------------- about --------------------
{ var message = "<p>jScan 1.2<br />";
  message += "<a href='http://www.italian.org.cn/app/' target='_blank'>www.italian.org.cn/app/</a><br /><br /><br />";
  message += "Zhang Hong<br />";
  message += "<a href='mailto:app@italian.org.cn'>app@italian.org.cn</a>"; 
  show(message); }

function help() // -------------------- help --------------------
{ var message = "<p>jScan is a JavaScript-based network scanner which can consecutively scan hosts and ports with specified timeout and interval.</p>";
  message += "<p>Before scanning, you need enter five values:</p>";
  message += "<p><li>[From]: first host (*.*.*.0-255)</li>";
  message += "<li>[To]: last host (*.*.*.0-255)</li>";
  message += "<li>[Port]: port of hosts (0-65535)</li>";
  message += "<li>[Timeout]: scanning timeout in milliseconds (1000-9999)</li>";
  message += "<li>[Interval]: interval between two scannings in seconds (1-99)</li></p>";
  message += "<p>Click [Scan] to start scanning. Blue host:port is active, red host:port is inactive.</p>";
  message += "<p>Click [Reload] to terminate scanning and reload jScan.</p>";
  show(message); }
</script>
</head>

<body>
<form name="jscan">

<p>jScan</p>

<p><table border=0 cellpadding=6><tr>
<td>From<br /><input type="text" name="from" size=15 maxlength=15 /></td>
<td>To<br /><input type="text" name="to" size=15 maxlength=15 /></td>
<td>Port<br /><input type="text" name="port" size=5 value=80 maxlength=5 /></td>
<td>Timeout<br /><input type="text" name="timeout" size=4 value=5000 maxlength=4 /></td>
<td>Interval<br /><input type="text" name="interval" size=2 value=2 maxlength=2 /></td>
<td>&nbsp;<br /><input type="button" id="_scan" value="Scan" onclick="scan()" />
<input type="button" id="_reload" value="Reload" onclick="location.reload(false)" /></td>
</tr></table></p>

<script type="text/javascript">
var random = Math.floor(Math.random() * list.length);
document.jscan.from.value = list[random] + ".0";
document.jscan.to.value = list[random] + ".255";
document.getElementById("_reload").style.display = "none";
</script>

<p><table border=0><tr><td><div id="message"></div></td></tr></table></p>

<p><table border=0><tr><td><div id="result"></div></td></tr></table></p>

<p><a href="javascript:void(0)" onclick="about()">About</a> + <a href="javascript:void(0)" onclick="help()">Help</a></p>

<script type="text/javascript">
if (! navigator.onLine)
{ document.jscan.from.disabled = "disabled";
  document.jscan.to.disabled = "disabled";
  document.jscan.port.disabled = "disabled";
  document.jscan.timeout.disabled = "disabled";
  document.jscan.interval.disabled = "disabled";
  document.getElementById("_scan").disabled = "disabled";
  document.getElementById("message").innerHTML = "<span class='red'>jScan can't work because your computer or smartphone isn't online.</span>"; }
</script>

</form>
</body>
</html>

<!--
1/ nslookup -q=TXT _spf.google.com 114.114.114.114
2/ _netblocks.google.com
3/ nslookup -q=TXT _netblocks.google.com 114.114.114.114
4/ 173.194.0.0/16
   207.126.144.0/20
   209.85.128.0/17
   216.239.32.0/19
   64.18.0.0/20
   64.233.160.0/19
   66.102.0.0/20
   66.249.80.0/20
   72.14.192.0/18
   74.125.0.0/16
-->